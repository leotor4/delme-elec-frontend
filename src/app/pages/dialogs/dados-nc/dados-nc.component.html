<div class="d-flex flex-lg-row flex-column justify-content-between mt-4">
    <div class="d-flex">
        <div class="cabecalho">
            <div class="d-flex align-items-center">
                <h1 class="mr-3">Informações da NC</h1>
            </div>
            <p>
                Visualize os detalhes cadastrados nesta NC.
            </p>
        </div>
    </div>
    <div class="d-flex justify-content-end align-items-center mb-3">
        <button
                [class]="isAllOpen ? selectedClass : unselectedClass"
                class="mr-2 btn-sm"
                (click)="isAllOpen = true"
        >
            <i class="bi bi-arrows-expand"></i>
            Expandir Todos
        </button>
        <button
                [class]="isAllOpen ? unselectedClass : selectedClass"
                (click)="isAllOpen = false"
                class="btn-sm"
        >
            <i class="bi bi-arrows-collapse"></i>
            Colapsar Todos
        </button>
        <button
                pButton
                class="p-button-danger p-button-text ml-2"
                (click)="this.ref.close()"
        >
            <i class="pi pi-times"></i>
        </button>
    </div>
</div>
<p-accordion [multiple]="true">
    <p-accordionTab [selected]="isAllOpen">
        <ng-template pTemplate="header">
            <div class="d-flex justify-content-between accordion">
                <p>
                    <i class="bi bi-file-earmark-text"></i>
                    Identificação da NC
                </p>
            </div>
        </ng-template>
        <ng-template pTemplate="content">
            <div class="div-ident-parceiro d-flex mt-3 flex-column flex-lg-row">
                <div class="div-ident-parceiro">
                    <h2>
                        <i class="bi bi-card-text"></i>
                        Dados de Identificação
                    </h2>
                    <div class="d-flex justify-content-between flex-column flex-lg-row">
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-ticket-perforated mr-1"></i>
                            <div>
                                <span class="info-titulo">Número</span>
                                <br />
                                <span class="info-dados">{{this.nc?.code||""}}</span>
                            </div>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-calendar-week mr-1"></i>
                            <div>
                                <span class="info-titulo">Data de Abertura</span>
                                <br />
                                <span class="info-dados">
            {{formato_brasileiro(this.nc?.data_abertura)}}

          </span>
                            </div>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-calendar-week mr-1"></i>
                            <div>
                                <span class="info-titulo">Prazo de Fechamento</span>
                                <br/>
                                <span class="info-dados">
            {{formato_brasileiro(this.nc?.data_fechamento)}}

          </span>
                            </div>
                        </div>
                    </div>
                </div>
                <p-divider class="test1" layout="vertical"></p-divider>
                <div class="div-ident-parceiro">
                    <h2>
                        <i class="bi bi-people mr-1"></i>
                        Dados de Emissão
                    </h2>
                    <div class="d-flex justify-content-between flex-column flex-lg-row">
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-person-circle mr-1"></i>
                            <div>
                                <span class="info-titulo">Emissor</span>
                                <br/>
                                <span class="info-dados">{{this.nc?.issuer?.username||"não preenchido"}}</span>
                            </div>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-person-circle mr-1"></i>
                            <div>
                                <span class="info-titulo">Responsável</span>
                                <br/>
                                <span class="info-dados">Janaína</span>
                            </div>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-geo-alt mr-1"></i>
                            <div>
                                <span class="info-titulo">Departamento</span>
                                <br>
                                <p class="info-dados">Rh</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="div-ident-parceiro mt-3">
                <h1 class="titulo-parceiro">Dados do Parceiro</h1>
                <div class="d-flex">
                    <div class="item">
                        <div class="dados-parceiro razao-social">
                            <div class="d-flex">
                                <h2 class="mr-2">Razão Social</h2>
                                <p-chip>
                                    <i class="bi bi-ticket-perforated mr-2"></i>
                                    {{ (this.nc?.customer?.code||this.nc?.provider?.code)||"00000000" }}
                                </p-chip>
                            </div>
                            <p>
                                {{(this.nc?.customer?.corporate_name||this.nc?.provider?.corporate_name||this.nc?.sector?.name)
                            ||"Dado não preenchido"}}
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <div class="dados-parceiro">
                            <div class="dados-contato">
                                <h1>Dados do Contato</h1>
                                <div></div>
                                <div class="contato-info d-flex flex-row">
                                    <i class="pi pi-user"></i>
                                    <div>
                                        <span class="info-titulo">Nome</span>
                                        <br />
                                        <span class="info-dados">
                {{(this.nc?.customer?.responsible_name||this.nc?.provider?.responsible_name||this.nc?.sector?.responsible_name)
                                        ||"Dado não preenchido"}}
              </span>
                                    </div>
                                </div>
                                <div class="contato-info d-flex flex-row">
                                    <i class="pi pi-phone"></i>
                                    <div>
                                        <span class="info-titulo">Telefone</span>
                                        <br />
                                        <span class="info-dados">
                {{(this.nc?.customer?.responsible_phone||this.nc?.provider?.responsible_phone||this.nc?.sector?.responsible_phone)
                                        ||"(00) 00000-0000"}}
              </span>
                                    </div>
                                </div>
                                <div class="contato-info d-flex flex-row">
                                    <i class="pi pi-at"></i>
                                    <div>
                                        <span class="info-titulo">E-mail</span>
                                        <br />
                                        <span class="info-dados">
                {{(this.nc?.customer?.responsible_email||this.nc?.provider?.responsible_email||this.nc?.sector?.responsible_email)
                                        ||"Dado não preenchido"}}
              </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="div-ident-parceiro d-flex flex-column flex-lg-row mt-3">
                <div class="dados-parceiro razao-social item ">
                    <h2 class="mr-2">
                        <i class="bi bi-file-earmark-text"></i>
                        Descrição da Não Conformidade
                    </h2>
                    <p-editor [style]="{'height':'144px', border: '1px solid #dddddd' }" [readonly]="true" [ngModel]="this.nc?.text_area_nc">
                        <ng-template pTemplate="header">
                        </ng-template>
                    </p-editor>
                </div>
                <p-divider layout="vertical"></p-divider>
                <div class="dados-parceiro razao-social item">
                    <h2 class="mr-2 mb-5">
                        <i class="pi pi-camera"></i>
                        Evidencias fotográficas
                    </h2>
                    <p-carousel [value]="this.nc?.attachments?.filter(isType1) || []" [numVisible]="3" [numScroll]="3" [showIndicators]="false">
                        <ng-template let-file pTemplate="item" >
                            <div><i class="bi bi-file-earmark fs-1"></i>
                                <p>{{file.name||"file.txt"}}</p></div>
                        </ng-template>
                    </p-carousel>
                </div>
            </div>
            <div class="div-ident-parceiro d-flex  mt-3">
                <div class="dados-parceiro razao-social item">
                    <h2 class="mr-2">
                        <i class="bi bi-geo"></i>
                        Descrição de Ações Imediatas
                    </h2>
                    <p-editor [style]="{'height':'144px', border: '1px solid #dddddd' }" [readonly]="true" [ngModel]="this.nc?.text_area_acoes">
                        <ng-template pTemplate="header" hidden>
                        </ng-template>
                    </p-editor>
                </div>
                <p-divider layout="vertical"></p-divider>
                <div class="dados-parceiro razao-social item">
                    <h2 class="mr-2 mb-5">
                        <i class="pi pi-camera"></i>
                        Evidencias fotográficas
                    </h2>
                    <p-carousel [value]="this.nc?.attachments?.filter(isType2) || []" [numVisible]="3" [numScroll]="3" [showIndicators]="false">
                        <ng-template let-file pTemplate="item">
                            <div >
                                <i class="bi bi-file-earmark fs-1"></i>
                                <p>{{file.name||"file.txt"}}</p>
                            </div>
                        </ng-template>
                    </p-carousel>
                </div>
            </div>

        </ng-template>
    </p-accordionTab>
    <p-accordionTab [selected]="isAllOpen">
        <ng-template pTemplate="header">
            <div class="d-flex justify-content-between accordion">
                <p>
                    <i class="bi bi-box-seam"></i>
                    Produtos e Pontos
                </p>
            </div>
        </ng-template>
        <ng-template pTemplate="content">
            <div class="div-ident-parceiro row">
                <h1 class="titulo-parceiro">Dados do Produto</h1>
                <div class="dados-parceiro col razao-social">
                    <div class="d-flex">
                        <h2 class="mr-2">
                            {{this.nc?.product?.name||"Dado não preenchido"}}
                        </h2>
                        <p-chip>
                            <i class="bi bi-ticket-perforated mr-2"></i>
                            {{this.nc?.product?.code||"000000"}}
                        </p-chip>
                    </div>
                    <p class="d-block">
                        {{this.nc?.product?.description||"Dado não preenchido"}}
                    </p>
                </div>
                <div class="dados-parceiro col">
                    <div class="dados-contato">
                        <div class="d-flex justify-content-between">
                            <h2>Dados de NC</h2>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-calculator"></i>
                            <div>
                                <span class="info-titulo">Quantidade Total</span>
                                <br />
                                <span class="info-dados">{{this.nc?.quant_total||""}}</span>
                            </div>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-calculator"></i>
                            <div>
                                <span class="info-titulo">Quantidade em Não Conformidade</span>
                                <br />
                                <span class="info-dados">{{this.nc?.quant_nc||""}}</span>
                            </div>
                        </div>
                        <div class="contato-info d-flex flex-row">
                            <i class="bi bi-percent"></i>
                            <div>
                                <span class="info-titulo">Percentual</span>
                                <br />
                                <span class="info-dados">{{getPercent()||"0"}}%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="div-ident-parceiro mt-3">
                <h2>
                    <i class="bi bi-people"></i>
                    Ponto de Controle
                </h2>
                <div class="d-flex">
                    <div class="col-6 d-flex flex-row">
                        <i class="pi pi-directions mr-1"></i>
                        <div>
        <span class="info-titulo">{{
            this.nc?.tipo_controle || "Dado não preenchido"
            }}</span>
                        </div>
                    </div>
                    <div class="d-flex flex-row" *ngIf="this.nc?.tipo_controle!='PR'">
                        <i class="bi bi-calculator mr-1"></i>
                        <div >
                            <span class="info-titulo">Número</span>
                            <br />
                            <p class="info-dados">
                                {{
                                (this.nc?.num_op || this.nc?.num_nota)|| "Dado não preenchido"
                                }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="div-ident-parceiro pr-4 mt-3">
                <h2>
                    <i class="bi bi-people"></i>
                    Ponto de Rejeição
                </h2>
                <div class="d-flex dados-contato mb-3 ">
                    <div class="contato-info d-flex flex-row mb-5 mr-5" *ngIf="this.nc?.num_lote">
                        <i class="bi bi-123"></i>
                        <div>
                            <span class="info-titulo">Número do Lote</span>
                            <br />
                            <span class="info-dados">{{
                                this.nc?.num_lote || "0"
                                }}</span>
                        </div>
                    </div>
                    <div class="contato-info d-flex flex-row mb-5 mr-5" *ngIf="this.nc?.num_ordem_compra">
                        <i class="bi bi-123"></i>
                        <div>
                            <span class="info-titulo">Quantidade em Não Conformidade</span>
                            <br />
                            <span class="info-dados">{{
                                this.nc?.num_ordem_compra || "0"
                                }}</span>
                        </div>
                    </div>
                    <div class="contato-info d-flex flex-row mb-5 mr-5" *ngIf="this.nc?.instruction?.code">
                        <i class="bi bi-123"></i>
                        <div>
                            <span class="info-titulo">IT</span>
                            <br />
                            <span class="info-dados">{{ "Numero: " + this.nc?.instruction?.code || "0" }}</span>
                            <br />
                            <span class="info-dados">{{ "Descrição: " + this.nc?.instruction?.description || "0" }}</span>
                            <br />
                            <span class="info-dados">{{ "Revisão: " + this.nc?.instruction?.rev || "0" }}</span>
                        </div>
                    </div>
                    <div class="contato-info d-flex flex-row mb-5 mr-5" *ngIf="this.nc?.procedure">
                        <i class="bi bi-123"></i>
                        <div>
                            <span class="info-titulo">Número PR</span>
                            <br />
                            <span class="info-dados">{{ this.nc?.procedure?.code|| "0" }}</span>
                        </div>
                    </div>
                </div>
                <div class="dados-parceiro col razao-social">
                    <p-editor
                            [ngModel]="this.nc?.text_area_reject_point"
                            [style]="{ height: '100%', border: '0px solid #dddddd'}"
                            [readonly]="true"
                    >
                        <ng-template pTemplate="header" hidden> </ng-template>
                    </p-editor>
                </div>
            </div>

        </ng-template>
    </p-accordionTab>
</p-accordion>

